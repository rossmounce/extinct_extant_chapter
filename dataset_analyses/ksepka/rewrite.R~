setwd("/home/ross/Dropbox/a_thesis/extinct_extant_chapter/ksepka")
library(phangorn)

meantablerf <- {}
meantablepd <- {}


#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref2.tre")
tr2 <- read.tree("jack1.tre")

class(ref2)
class(tr2)

#treedist(tr2[[1]],ref2[[1]])
#treedist(tr2[[1]],xxx[[1]])
#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 # loop counter
if(class(tr2)=="phylo") {
  tr2 <- list(tr2)
} else if (class(ref2)=="phylo"){
  ref2 <- list(ref2)
}
for (i in length(tr2)) {
  for (j in length(ref2)) {
    x[ii, ] <- c(i, j, treedist(tr2[[i]],ref2[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
    min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
    kk <- kk+1
  }
meantablerf <- mean(min[,2]) #zmean RF closest trees between pruned and deleted sets
meantablepd <- mean(min[,3]) #zmean PD closest trees between pruned and deleted sets
