setwd("/home/ross/Dropbox/a_thesis/extinct_extant_chapter/ksepka")
library(phangorn)

meantablerf <- {}
meantablepd <- {}


#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref2.tre")
tr2 <- read.tree("jack1.tre")

class(ref2)
class(tr2)
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"

convertphylo <- function(x) {
if(class(x)=="phylo") {
  x <- list(x)
} else
print("no")
}
convertphylo(tr2)
convertphylo(ref2)

yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)


treedist(tr2[[1]],ref2[[1]])
treedist(tr2[[1]],xxx[[1]])
#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
if(class(tr2)=="phylo") {
  tr2 <- list(tr2)
} else if (class(ref2)=="phylo"){
  ref2 <- list(ref2)
}
for (i in length(tr2)) {
  for (j in length(ref2)) {
    x[ii, ] <- c(i, j, treedist(tr2[[i]],ref2[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
    min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
    kk <- kk+1
  }
meantablerf <- mean(min[,2]) #zmean RF closest trees between pruned and deleted sets
meantablepd <- mean(min[,3]) #zmean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref3.tre")

tr2 <- read.tree("jack2.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref4.tre")

tr2 <- read.tree("jack3.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref5.tre")

tr2 <- read.tree("jack4.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref6.tre")

tr2 <- read.tree("jack5.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref7.tre")

tr2 <- read.tree("jack6.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref8.tre")

tr2 <- read.tree("jack7.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref9.tre")

tr2 <- read.tree("jack8.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref10.tre")

tr2 <- read.tree("jack9.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref11.tre")

tr2 <- read.tree("jack10.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref12.tre")

tr2 <- read.tree("jack11.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref13.tre")

tr2 <- read.tree("jack12.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref14.tre")

tr2 <- read.tree("jack13.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref15.tre")

tr2 <- read.tree("jack14.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref16.tre")

tr2 <- read.tree("jack15.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref17.tre")

tr2 <- read.tree("jack16.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref18.tre")

tr2 <- read.tree("jack17.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref19.tre")

tr2 <- read.tree("jack18.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref20.tre")

tr2 <- read.tree("jack19.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref21.tre")

tr2 <- read.tree("jack20.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref22.tre")

tr2 <- read.tree("jack21.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref23.tre")

tr2 <- read.tree("jack22.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref24.tre")

tr2 <- read.tree("jack23.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref25.tre")

tr2 <- read.tree("jack24.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref26.tre")

tr2 <- read.tree("jack25.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref27.tre")

tr2 <- read.tree("jack26.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref28.tre")

tr2 <- read.tree("jack27.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref29.tre")

tr2 <- read.tree("jack28.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref30.tre")

tr2 <- read.tree("jack29.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref31.tre")

tr2 <- read.tree("jack30.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref32.tre")

tr2 <- read.tree("jack31.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref33.tre")

tr2 <- read.tree("jack32.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref34.tre")

tr2 <- read.tree("jack33.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref35.tre")

tr2 <- read.tree("jack34.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref36.tre")

tr2 <- read.tree("jack35.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref37.tre")

tr2 <- read.tree("jack36.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref38.tre")

tr2 <- read.tree("jack37.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets



#jack REFERENCE trees 264 PAUP numbering hence 2
ref2 <- read.tree("ref39.tre")

tr2 <- read.tree("jack38.tre")
xxx <- vector("list",5000)
class(xxx) <- "multiPhylo"
xxx <- list(tr2)
yyy <- vector("list",5000)
class(yyy) <- "multiPhylo"
yyy <- list(ref2)

#all reference trees to one comp tree
x <- matrix(ncol = 4, nrow = prod(length(tr2), length(ref2)))
ii <- 1 ## loop counter
for (i in seq_along(tr2)) {
  for (j in seq_along(ref2)) {
    x[ii, ] <- c(i, j, treedist(xxx[[i]],yyy[[j]]))
    ii <- ii+1
  }
}
#colnames(x) <- c("j","ref","rf","pd")
min <- matrix(ncol = 3, nrow = length(tr2))
kk <- 1 ## loop counter
for (i in seq_along(tr2)) {
  min[kk, ] <- c(i, min((subset(x, x[,1] == i , drop=FALSE))[,3]), min((subset(x, x[,1] == i , drop=FALSE))[,4]))
  kk <- kk+1
}
meantablerf <- rbind(meantablerf,mean(min[,2])) #ean RF closest trees between pruned and deleted sets
meantablepd <- rbind(meantablepd,mean(min[,3])) #ean PD closest trees between pruned and deleted sets


write.csv(cbind(meantablerf,meantablepd),file="Rout.csv")
